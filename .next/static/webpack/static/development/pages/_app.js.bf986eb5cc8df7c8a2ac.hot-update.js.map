{"version":3,"file":"static/webpack/static/development/pages/_app.js.bf986eb5cc8df7c8a2ac.hot-update.js","sources":["webpack:///./with-redux.js"],"sourcesContent":["import React from 'react'\nimport createStore from './store'\n\n\nconst isServer = typeof window === 'undefined'\nconst __NEXT_REDUX_STORE__ = '__NEXT_REDUX_STORE__'\n\nconst getOrCreateStore = (initialState) => {\n  if (isServer) {\n    return createStore(initialState)\n  }\n\n  if (!window[__NEXT_REDUX_STORE__]) {\n    window[__NEXT_REDUX_STORE__] = createStore(initialState)\n  }\n\n  return window[__NEXT_REDUX_STORE__]\n}\nexport default MyApp => {\n\n  class WithReduxApp extends React.Component {\n    constructor (props) {\n      console.log('WithReduxApp constructor::::initialReduxState', props.initialReduxState)\n      super(props)\n      this.reduxStore = getOrCreateStore(props.initialReduxState)\n    }\n\n    render () {\n      const { Component, pageProps, ...rest } = this.props\n      if (pageProps) {\n        pageProps.test = '123'\n      }\n  \n      return <MyApp\n        Component={Component}\n        pageProps={pageProps}\n        {...rest}\n        reduxStore={this.reduxStore} // 注入\n      />\n    }\n  }\n\n  \n\n  WithReduxApp.getInitialProps = async (ctx) => {\n    console.log('WithReduxApp getInitialProps::::')\n    const reduxStore = getOrCreateStore()\n    ctx.reduxStore = reduxStore\n    let appProps = {}\n    if (typeof MyApp.getInitialProps === 'function') {\n      appProps = await MyApp.getInitialProps(ctx)\n    }\n\n    return {\n      ...appProps,\n      initialReduxState: reduxStore.getState() // 脱水,在此是不能返回reduxStore，因为这里return的内容最终会被拍平，放在html的script标签内，客户端代码可以通过props获取到\n    }\n  }\n\n  return WithReduxApp\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AAHA;AAIA;AACA;AARA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AArBA;AACA;AADA;AAAA;AACA;AAyBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAMA;AACA;AAPA;AAAA;AAWA;AACA;AAZA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAcA;AACA;;;;A","sourceRoot":""}